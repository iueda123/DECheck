# Quality Assessment Form

## Study Identification

- **Study ID**: Bayer2022
- **Reference File Names**: Bayer2022.pdf.md, 1-s2.0-S1053811922008205-mmc1.pdf.md
- **Author, Journal, Year**: Bayer et al., Neuroimage, 2022
- **Title**: Accommodating Site Variation In Neuroimaging Data Using Normative And Hierarchical Bayesian Models
- **DOI**: 10.1101/2021.02.09.430363

---

## Assessment Items - Group A

### 1. Clarity of Research Objectives

- **Answer**: Yes
- **Confidence Rating**: High
- **Negative Answer Category**: Not Negative
- **Reason**: The research objectives are clearly stated in the abstract and introduction. The paper aims to propose and evaluate a hierarchical Bayesian modeling approach to account for site effects in multi-site neuroimaging data, particularly in the context of normative modeling.
- **Supporting Text**: In this study, we suggest accommodating for these site effects by including them as random effects in a hierarchical Bayesian model. We compared the performance of a linear and a non-linear hierarchical Bayesian model in modeling the effect of age on cortical thickness... We compared the proposed single stage hierarchical Bayesian method to several harmonization techniques commonly used to deal with additive and multiplicative site effects using a two stage regression... Our results show the value of hierarchical Bayesian regression...
- **Location**: Bayer2022.pdf.md, lines 60-73

### 2. Clear Definition of Target Population

- **Answer**: Yes
- **Confidence Rating**: High
- **Negative Answer Category**: Not Negative
- **Reason**: The target population is clearly defined. The study uses data from the Autism Brain Imaging Data Exchange (ABIDE) dataset, including healthy controls and individuals with autism. The paper specifies the number of participants, their age range, and sex distribution.
- **Supporting Text**: For this study, we used 569 controls for development and performance testing of the models, out of which 470 were male. In a subsequent step, we applied the hierarchical Bayesian models to 482 individuals with autism from the same data set, out of which 430 were male.
- **Location**: Bayer2022.pdf.md, lines 263-266

### 3. Clarity of Inclusion and Exclusion Criteria

- **Answer**: Partial
- **Confidence Rating**: Medium
- **Negative Answer Category**: Unclear/Incomplete
- **Reason**: The paper mentions outlier removal as an exclusion criterion, but it does not provide a comprehensive description of the inclusion and exclusion criteria for the participants in the ABIDE dataset. It refers to the original ABIDE paper for more details.
- **Supporting Text**: As a first step, the measures were scanned for outliers. The criterion applied to mark a value as an outlier was if it was above or beyond 2 inter quartile ranges from the mean of all values for that region and hemisphere. This quite liberal criterion was applied with the aim to detect not outliers in a mathematical sense (+/- 95 % confidence interval), but to detect impossible values. This leads to the removal of 1055 out of 162905 data points (0.006%) of all values.
- **Location**: Bayer2022.pdf.md, lines 283-287

### 4. Validity of Normative Modeling Outcome Measures

- **Answer**: Yes
- **Confidence Rating**: High
- **Negative Answer Category**: Not Negative
- **Reason**: The outcome measures from normative modeling (z-scores) are clearly defined and their calculation is explained. The paper also discusses the interpretation of these scores.
- **Supporting Text**: Finally, each individual's z-score of deviation can be calculated via: ... where /u1D70E * 2 is the predictive variance that can be calculated the following...
- **Location**: Bayer2022.pdf.md, lines 400-403

### 5. Handling of Confounding Variables

- **Answer**: Yes
- **Confidence Rating**: High
- **Negative Answer Category**: Not Negative
- **Reason**: The paper's main focus is on handling the confounding variable of 'site'. It explicitly models site as a random effect in a hierarchical Bayesian model. Age and sex are also included as covariates in the models.
- **Supporting Text**: We propose a hierarchical Bayesian approach in which we include site as a random effect in the model, avoiding the exclusion of meaningful variance correlated with site by predicting site effects as part of the model instead of removing them from the data.
- **Location**: Bayer2022.pdf.md, lines 201-204

### 6. Clarity of Data Sources

- **Answer**: Yes
- **Confidence Rating**: High
- **Negative Answer Category**: Not Negative
- **Reason**: The data source is clearly stated as the ABIDE (Autism Brain Imaging Data Exchange) dataset. The paper provides a link to the dataset's website.
- **Supporting Text**: The ABIDE consortium (http://preprocessed-connectomesproject.org/abide/) was founded to facilitate research and collaboration on autism spectrum disorders by data aggregation and sharing.
- **Location**: Bayer2022.pdf.md, lines 259-261

### 7. Description of Image Acquisition Protocol

- **Answer**: Partial
- **Confidence Rating**: Medium
- **Negative Answer Category**: Unclear/Incomplete
- **Reason**: The paper provides a table summarizing the scanner parameters for each site in the ABIDE dataset, but it does not go into great detail about the image acquisition protocols. It mentions that the data was collected with 3 Tesla scanners and that sequence parameters varied across sites.
- **Supporting Text**: Although all data has been collected with 3 Tesla scanners and preprocessed in a harmonized way (Craddock et al., 2013), sequence parameters for anatomical and functional data, as well as type of scanner varied across sites (Di Martino et al., 2014). In addition, sites differ in distribution of age and sex and in sample size. An overview of site-specific data is provided in Table 1 and in (Di Martino et al., 2014).
- **Location**: Bayer2022.pdf.md, lines 274-278

---

## Assessment Items - Group B

### 1. Details of Data Preprocessing

- **Answer**: Yes
- **Confidence Rating**: High
- **Negative Answer Category**: Not Negative
- **Reason**: The paper states that the data was preprocessed using a standardized protocol from the Preprocessed Connectomes Project, which used the FreeSurfer standard pipeline. It also describes the outlier removal process.
- **Supporting Text**: The data were processed using a standardized protocol (Craddock et al., 2013) of the FreeSurfer standard pipeline (Desikan-Kiliany Atlas) as part of the Preprocessed Connectomes Project (Craddock et al., 2013) and has been made available for download on the preprocessed section of the ABIDE initiative.
- **Location**: Bayer2022.pdf.md, lines 266-269

### 2. Clarity of Data Partitioning Methods

- **Answer**: Yes
- **Confidence Rating**: High
- **Negative Answer Category**: Not Negative
- **Reason**: The data partitioning method is clearly described. The data was split into a 70% training set and a 30% test set, preserving the distribution of age, sex, and site.
- **Supporting Text**: To evaluate the performance of the models, we split the the healthy control data set into a training set (70% of data, n=389) and a test set (30% of data, n=166) using the R package caret and splitstackshape, while the distribution of age, sex and site was preserved between sets.
- **Location**: Bayer2022.pdf.md, lines 291-294

### 3. Details of Normative Modeling Approach

- **Answer**: Yes
- **Confidence Rating**: High
- **Negative Answer Category**: Not Negative
- **Reason**: The paper provides a detailed mathematical and conceptual description of the hierarchical Bayesian modeling approach, including a linear and a non-linear (Gaussian Process) version. It also specifies the software used (Stan).
- **Supporting Text**: With the aim to create reliable normative models in multi-site neuroimaging data, we developed and compared two versions of a hierarchical Bayesian models that include site as a predictor. In a hierarchical linear version of the model, site is modeled hierarchically, resulting in a random effect for site ('Hierarchical Bayesian Linear Model, HBLM'). In a non-linear version of the model, a Gaussian Process for age is added to test whether performance is increased if the model is also able to capture non-linear effects between age and thickness of the cortical region ('Hierarchical Bayesian Gaussian Process Model, HBGPM').
- **Location**: Bayer2022.pdf.md, lines 302-308

### 4. Details of Training Algorithm

- **Answer**: Yes
- **Confidence Rating**: High
- **Negative Answer Category**: Not Negative
- **Reason**: The paper describes the use of Stan for Bayesian inference, which uses the No-U-Turn Sampler (NUTS), a variant of Hamiltonian Monte Carlo. It also mentions the number of iterations and warm-up period.
- **Supporting Text**: Both the hierarchical Bayesian and the comparison model version of the normative models were implemented in Stan (Carpenter et al., 2017; Stan Development Team, 2020b), a probabilistic C++ based programming language to perform Bayesian Inference, and analyzed in R (R Core Team, 2020) using the package rstan (Stan Development Team, 2020a). Stan allows to directly compute the log posterior density of a model given the known variables x and y. It uses the No-U-Turn Sampler (NUTS) (Hoffman and Gelman, 2014), a variation of Hamiltonian Monte-Carlo Sampling (Duane et al., 1987; Neal et al., 2011; Neal, 1994) to generate representative samples from the posterior distribution of parameters and hyper parameters θ, each of which has the marginal distribution p(θ | y, x).
- **Location**: Bayer2022.pdf.md, lines 440-448

### 5. Model Performance Evaluation Metrics

- **Answer**: Yes
- **Confidence Rating**: High
- **Negative Answer Category**: Not Negative
- **Reason**: The paper clearly defines the metrics used to evaluate model performance, including Pearson's correlation coefficient (ρ), Standardized Root Mean Squared Error (SRMSE), log-likelihood (LL), Explained Variance (EV), and Mean Standardized Log-Loss (MSLL).
- **Supporting Text**: Model performance is assessed using several common performance metrics. The Pearson's correlation coefficient ρ indicates the linear association between true and predicted value of cortical thickness measures... we also calculate the standardized version of the root mean squared error (SRMSE) and the point-wise log-likelihood at each data point in the test set... we also compute the proportion of variance explained (EV) by the predicted values and a standardized version of the log-loss (mean standardized log-loss, MSLL (Rasmussen and Williams, 2006)).
- **Location**: Bayer2022.pdf.md, lines 340-348

### 6. Implementation of Internal Validation

- **Answer**: Yes
- **Confidence Rating**: High
- **Negative Answer Category**: Not Negative
- **Reason**: Internal validation was performed by splitting the data into training and test sets. The models were trained on the training set and evaluated on the unseen test set.
- **Supporting Text**: To evaluate the performance of the models, we split the the healthy control data set into a training set (70% of data, n=389) and a test set (30% of data, n=166) using the R package caret and splitstackshape, while the distribution of age, sex and site was preserved between sets.
- **Location**: Bayer2022.pdf.md, lines 291-294

### 7. External Data Validation

- **Answer**: No
- **Confidence Rating**: High
- **Negative Answer Category**: Missing
- **Reason**: The study did not perform external validation on a completely independent dataset from a different source. The test set was a split from the same ABIDE dataset.
- **Supporting Text**: 
- **Location**: 

### 8. Description of Dataset Characteristics

- **Answer**: Yes
- **Confidence Rating**: High
- **Negative Answer Category**: Not Negative
- **Reason**: The paper provides a table with the characteristics of each site in the ABIDE dataset, including sample size, sex distribution, and age range. It also provides a figure showing the distribution of age and sex for the training and test sets.
- **Supporting Text**: An overview of site-specific data is provided in Table 1 and in (Di Martino et al., 2014)... An overview of the distribution of age and sex for the training and test sets for healthy controls and individuals with autism can be found in Fig. 2
- **Location**: Bayer2022.pdf.md, lines 277-278 and 300-301

### 9. Performance Metrics and Statistical Uncertainty

- **Answer**: Yes
- **Confidence Rating**: High
- **Negative Answer Category**: Not Negative
- **Reason**: The paper reports performance metrics with standard deviations and provides detailed statistical comparisons between models, including p-values. The Bayesian framework itself provides a measure of uncertainty for the parameter estimates.
- **Supporting Text**: Cell values indicate post-hoc comparison significance values (adjusted by tukey method for a comparing a family of 6 estimates). Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 ns. blue: test set. yellow: training set.
- **Location**: Bayer2022.pdf.md, lines 700-702

### 10. Consideration for Reproducibility

- **Answer**: Yes
- **Confidence Rating**: High
- **Negative Answer Category**: Not Negative
- **Reason**: The paper provides links to the public dataset (ABIDE), the software used (Stan, R), and the code for the models on GitHub.
- **Supporting Text**: We declare that all software, data and code used for this paper is publicly available. The ABIDE (autism brain imaging data exchange) (Di Martino et al., 2014) data setis available at: http://preprocessed-connectomes-project.org/abide/. The software package Stan (Stan Development Team, 2020b) is available at: https://mc-stan.org/users/interfaces/. The software package R (R Core Team, 2020) is available at: https://www.r-project.org. The R-package rstan (Stan Development Team, 2020a) is available at: https://cran.rproject.org/web/packages/rstan/index.html. The Stan code for the HBLM, HBGPM and simple Bayesian linear model are available at: https://github.com/likeajumprope/ Bayesian_normative_models.
- **Location**: Bayer2022.pdf.md, lines 589-595

### 11. Interpretation Specific to Normative Modeling

- **Answer**: Yes
- **Confidence Rating**: High
- **Negative Answer Category**: Not Negative
- **Reason**: The paper discusses the interpretation of individual-level deviation scores (z-scores) and their clinical significance. It also compares the normative modeling approach to traditional case-control studies.
- **Supporting Text**: The advantage of the hierarchical Bayesian approach becomes particularly clear when considering that the scores derived from normative models are relative scores describing the deviation from a predicted normative mean. Thus, the normative deviation score is not affected by the absolute value of the predicted mean, and the number of predictors in the model does not influence the normative score.
- **Location**: Bayer2022.pdf.md, lines 543-547

---

## Additional Comments

**Additional Comments**: 
